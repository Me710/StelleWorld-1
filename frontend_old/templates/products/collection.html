{% extends "base.html" %}

{% block title %}{{ category_name }} - StelleWorld{% endblock %}

{% block extra_head %}
<!-- Google Fonts - Poppins & Montserrat -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<link rel="stylesheet" href="/static/css/collection.css">
{% endblock %}

{% block content %}
<!-- Hero section de la collection -->
<div class="collection-hero">
    <div class="container mx-auto px-4">
        <h1 class="collection-title" id="collection-title">{{ category_name|upper }}</h1>
        <p class="collection-description">{{ category_description }}</p>
    </div>
</div>

<!-- Barre d'outils de filtrage -->
<div class="collection-toolbar">
    <div class="container mx-auto px-4">
        <div class="toolbar-content">
            <!-- Bouton Filter -->
            <button id="filter-toggle" class="filter-toggle-btn">
                <i class="fas fa-sliders-h"></i>
                <span>Filter</span>
            </button>
            
            <!-- Compteur de produits -->
            <div class="products-count" id="products-count">
                <span id="products-count-text">36 Products</span>
            </div>
            
            <!-- Options de vue et tri -->
            <div class="view-sort-controls">
                <!-- Boutons de vue -->
                <div class="view-buttons">
                    <button id="grid-view-2" class="view-btn" title="2 colonnes">
                        <i class="fas fa-th-large"></i>
                    </button>
                    <button id="grid-view-3" class="view-btn" title="3 colonnes">
                        <i class="fas fa-th"></i>
                    </button>
                    <button id="grid-view-4" class="view-btn active" title="4 colonnes">
                        <i class="fas fa-grip-horizontal"></i>
                    </button>
                </div>
                
                <!-- Sélecteur de tri -->
                <div class="sort-select-wrapper">
                    <label for="sort-select" class="sort-label">Sort by:</label>
                    <select id="sort-select" class="sort-select">
                        <option value="best-selling">Best Selling</option>
                        <option value="price-asc">Price: Low to High</option>
                        <option value="price-desc">Price: High to Low</option>
                        <option value="newest">Newest</option>
                        <option value="rating">Top Rated</option>
                        <option value="alphabetical">Alphabetical: A-Z</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Contenu principal avec sidebar -->
<div class="collection-main">
    <div class="container mx-auto px-4">
        <div class="collection-layout">
            <!-- Sidebar de filtres -->
            <aside id="filter-sidebar" class="filter-sidebar">
                <div class="sidebar-header">
                    <h2 class="sidebar-title">Filtres</h2>
                    <button id="sidebar-close" class="sidebar-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="sidebar-content">
                    <!-- Filtres dynamiques seront injectés ici via JavaScript -->
                    <div id="dynamic-filters">
                        <!-- Exemple de section de filtre: PRODUCT TYPE -->
                        <div class="filter-section">
                            <h3 class="filter-title">PRODUCT TYPE</h3>
                            <div class="filter-options">
                                <label class="filter-option">
                                    <input type="checkbox" name="type" value="conditioner">
                                    <span class="filter-label">Conditioner</span>
                                    <span class="filter-count">(1)</span>
                                </label>
                                <label class="filter-option">
                                    <input type="checkbox" name="type" value="crochet-braid">
                                    <span class="filter-label">Crochet Braid</span>
                                    <span class="filter-count">(1)</span>
                                </label>
                                <label class="filter-option">
                                    <input type="checkbox" name="type" value="full-cap-wig">
                                    <span class="filter-label">Full Cap Wig</span>
                                    <span class="filter-count">(3)</span>
                                </label>
                                <label class="filter-option">
                                    <input type="checkbox" name="type" value="hair-growth">
                                    <span class="filter-label">Hair Growth</span>
                                    <span class="filter-count">(1)</span>
                                </label>
                                <label class="filter-option">
                                    <input type="checkbox" name="type" value="hair-styling">
                                    <span class="filter-label">Hair Styling</span>
                                    <span class="filter-count">(1)</span>
                                </label>
                            </div>
                            <button class="filter-show-more">
                                <i class="fas fa-plus"></i>
                                <span>Show More</span>
                            </button>
                        </div>
                        
                        <!-- Section BRAND -->
                        <div class="filter-section">
                            <h3 class="filter-title">BRAND</h3>
                            <div class="filter-options">
                                <label class="filter-option">
                                    <input type="checkbox" name="brand" value="outre">
                                    <span class="filter-label">Outre</span>
                                    <span class="filter-count">(8)</span>
                                </label>
                                <label class="filter-option">
                                    <input type="checkbox" name="brand" value="sensationnel">
                                    <span class="filter-label">Sensationnel</span>
                                    <span class="filter-count">(5)</span>
                                </label>
                                <label class="filter-option">
                                    <input type="checkbox" name="brand" value="isis">
                                    <span class="filter-label">Isis</span>
                                    <span class="filter-count">(3)</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Section PRICE -->
                        <div class="filter-section">
                            <h3 class="filter-title">PRICE</h3>
                            <div class="filter-price-range">
                                <div class="price-inputs">
                                    <input type="number" id="price-min" class="price-input" placeholder="Min" value="0">
                                    <span class="price-separator">-</span>
                                    <input type="number" id="price-max" class="price-input" placeholder="Max" value="1000">
                                </div>
                                <input type="range" id="price-range" class="price-slider" min="0" max="1000" step="10">
                            </div>
                        </div>
                        
                        <!-- Section AVAILABILITY -->
                        <div class="filter-section">
                            <h3 class="filter-title">AVAILABILITY</h3>
                            <div class="filter-options">
                                <label class="filter-option">
                                    <input type="checkbox" name="availability" value="in-stock">
                                    <span class="filter-label">In Stock</span>
                                    <span class="filter-count">(30)</span>
                                </label>
                                <label class="filter-option">
                                    <input type="checkbox" name="availability" value="out-of-stock">
                                    <span class="filter-label">Out of Stock</span>
                                    <span class="filter-count">(6)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bouton d'action -->
                    <div class="sidebar-actions">
                        <button id="reset-filters" class="btn-reset-filters">
                            Clear All Filters
                        </button>
                    </div>
                </div>
            </aside>
            
            <!-- Grille de produits -->
            <div class="products-container">
                <!-- Filtres actifs -->
                <div id="active-filters" class="active-filters" style="display: none;">
                    <div class="active-filters-header">
                        <span class="active-filters-title">Filtres actifs:</span>
                        <button id="clear-all-filters" class="clear-all-btn">Tout effacer</button>
                    </div>
                    <div id="active-filters-list" class="active-filters-list">
                        <!-- Les badges de filtres actifs seront ajoutés ici -->
                    </div>
                </div>
                
                <!-- Grille de produits -->
                <div id="products-grid" class="products-grid grid-4">
                    <!-- Les produits seront chargés dynamiquement -->
                </div>
                
                <!-- Indicateur de chargement -->
                <div id="loading-indicator" class="loading-indicator hidden">
                    <div class="spinner"></div>
                    <p>Chargement des produits...</p>
                </div>
                
                <!-- Message vide -->
                <div id="empty-state" class="empty-state hidden">
                    <i class="fas fa-inbox"></i>
                    <h3>Aucun produit trouvé</h3>
                    <p>Essayez d'ajuster vos filtres pour voir plus de résultats.</p>
                </div>
                
                <!-- Trigger pour infinite scroll -->
                <div id="infinite-scroll-trigger" style="height: 1px;"></div>
            </div>
        </div>
    </div>
</div>

<!-- Messages flash -->
<div id="flash-messages" class="fixed top-20 right-4 z-50 space-y-2">
    <!-- Les messages seront ajoutés ici via JavaScript -->
</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/collection-filters.js"></script>
<script>
// Initialiser avec les données de la catégorie
window.collectionSlug = "{{ category_slug }}";
window.categoryId = {% if category_id %}{{ category_id }}{% else %}null{% endif %};
window.categoryName = "{{ category_name }}";
</script>
{% endblock %}

